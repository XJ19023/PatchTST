>>> Step4 Model <<< enable smooth
Model(
  (model): PatchTST_backbone(
    (revin_layer): RevIN()
    (padding_patch_layer): ReplicationPad1d((0, 8))
    (backbone): TSTiEncoder(
      (W_P): Linear(in_features=16, out_features=128, bias=True)
      (dropout): Dropout(p=0.2, inplace=False)
      (encoder): TSTEncoder(
        (layers): ModuleList(
          (0): TSTEncoderLayer(
            (self_attn): _MultiheadAttention(
              (W_Q): QuantWrapper(quant_meth: BFP8, setp: -4, smooth: True, a: 0.15612806150541883)
              (W_K): QuantWrapper(quant_meth: BFP8, setp: -4, smooth: True, a: 0.029092286624739068)
              (W_V): QuantWrapper(quant_meth: BFP8, setp: -4, smooth: True, a: 0.029092286624739068)
              (sdp_attn): _ScaledDotProductAttention(
                (attn_dropout): Dropout(p=0.0, inplace=False)
              )
              (to_out): Sequential(
                (0): QuantWrapper(quant_meth: BFP4, setp: -4, smooth: True, a: 0.09439501723111712)
                (1): Dropout(p=0.2, inplace=False)
              )
            )
            (dropout_attn): Dropout(p=0.2, inplace=False)
            (norm_attn): Sequential(
              (0): Transpose()
              (1): BatchNorm1d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
              (2): Transpose()
            )
            (ff): Sequential(
              (0): QuantWrapper(quant_meth: INT8, setp: -4, smooth: True, a: 0.09669729431211563)
              (1): GELU(approximate='none')
              (2): Dropout(p=0.2, inplace=False)
              (3): QuantWrapper(quant_meth: BFP4, setp: -4, smooth: True, a: 0.2082418248161691)
            )
            (dropout_ffn): Dropout(p=0.2, inplace=False)
            (norm_ffn): Sequential(
              (0): Transpose()
              (1): BatchNorm1d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
              (2): Transpose()
            )
          )
          (1): TSTEncoderLayer(
            (self_attn): _MultiheadAttention(
              (W_Q): QuantWrapper(quant_meth: INT8, setp: -4, smooth: True, a: 0.0001289243613749585)
              (W_K): QuantWrapper(quant_meth: INT8, setp: -4, smooth: True, a: 9.561937206221333e-05)
              (W_V): QuantWrapper(quant_meth: INT8, setp: -4, smooth: False)
              (sdp_attn): _ScaledDotProductAttention(
                (attn_dropout): Dropout(p=0.0, inplace=False)
              )
              (to_out): Sequential(
                (0): QuantWrapper(quant_meth: BFP4, setp: -4, smooth: True, a: 0.21747903671736074)
                (1): Dropout(p=0.2, inplace=False)
              )
            )
            (dropout_attn): Dropout(p=0.2, inplace=False)
            (norm_attn): Sequential(
              (0): Transpose()
              (1): BatchNorm1d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
              (2): Transpose()
            )
            (ff): Sequential(
              (0): QuantWrapper(quant_meth: INT8, setp: -4, smooth: True, a: 0.17747845176889834)
              (1): GELU(approximate='none')
              (2): Dropout(p=0.2, inplace=False)
              (3): QuantWrapper(quant_meth: BFP4, setp: -4, smooth: True, a: 0.5158690111343979)
            )
            (dropout_ffn): Dropout(p=0.2, inplace=False)
            (norm_ffn): Sequential(
              (0): Transpose()
              (1): BatchNorm1d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
              (2): Transpose()
            )
          )
          (2): TSTEncoderLayer(
            (self_attn): _MultiheadAttention(
              (W_Q): QuantWrapper(quant_meth: BFP8, setp: -4, smooth: True, a: 0.030320757866158832)
              (W_K): QuantWrapper(quant_meth: BFP8, setp: -4, smooth: True, a: 0.3165269987014024)
              (W_V): QuantWrapper(quant_meth: BFP8, setp: -4, smooth: True, a: 0.3071304716027244)
              (sdp_attn): _ScaledDotProductAttention(
                (attn_dropout): Dropout(p=0.0, inplace=False)
              )
              (to_out): Sequential(
                (0): QuantWrapper(quant_meth: BFP4, setp: -4, smooth: True, a: 0.34627429727279696)
                (1): Dropout(p=0.2, inplace=False)
              )
            )
            (dropout_attn): Dropout(p=0.2, inplace=False)
            (norm_attn): Sequential(
              (0): Transpose()
              (1): BatchNorm1d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
              (2): Transpose()
            )
            (ff): Sequential(
              (0): QuantWrapper(quant_meth: BFP8, setp: -4, smooth: True, a: 0.3839683063291045)
              (1): GELU(approximate='none')
              (2): Dropout(p=0.2, inplace=False)
              (3): QuantWrapper(quant_meth: BFP4, setp: -4, smooth: True, a: 0.31229010729058454)
            )
            (dropout_ffn): Dropout(p=0.2, inplace=False)
            (norm_ffn): Sequential(
              (0): Transpose()
              (1): BatchNorm1d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
              (2): Transpose()
            )
          )
        )
      )
    )
    (head): Flatten_Head(
      (flatten): Flatten(start_dim=-2, end_dim=-1)
      (linear): Linear(in_features=5376, out_features=96, bias=True)
      (dropout): Dropout(p=0.0, inplace=False)
    )
  )
)

